<!DOCTYPE html>
<html data-theme="light" style="overflow-x: hidden;">
  <head style="overflow-x: hidden;">
    <meta charset="utf-8">
    <meta name="viewport" content="width=100%, initial-scale=1, user-scalable=no">
    <title>Harald Tverdal</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <script>
      document.addEventListener('DOMContentLoaded', () => {

        const $start_timer = document.getElementById("start_timer");
        $start_timer.style.visibility = "visible";
        const $timer_modal_close = document.getElementById("timer_modal_close");


    const navBar = document.getElementById("navbar_main");
    const navMenu = document.getElementById("navbar_menu");
    const burger = document.getElementById("navbar_burger");

      burger.addEventListener('click', ()=> {
        navBar.classList.toggle("is-active");
        burger.classList.toggle("is-active");
        navMenu.classList.toggle("is-active");
      });



// Get calculate button
const $calculate_button = document.getElementById("calculate_button");

const $cup_info = document.getElementById("cup_info");
const $cup_modal_close = document.getElementById("cup_modal_close");

const $about_button = document.getElementById("about_button");
const $about_modal_close = document.getElementById("about_modal_close");

global_cooltime = 0;


// Closes the about modal
$about_modal_close.addEventListener('click', () => {
    document.getElementById("about_modal").classList.remove("is-active");
});

// Opens the timer modal
$start_timer.addEventListener('click', () => {
    console.log("clicked cup info");
    document.getElementById("timer_modal").classList.add("is-active");
    document.getElementById("cooling_time_text").textContent("Cooling time: ");
});
// Closes the timer modal
$timer_modal_close.addEventListener('click', () => {
    document.getElementById("timer_modal").classList.remove("is-active");
});

function scie(input) {
    return Math.exp(input, 10);
}

// Function for interpolated polynomial for converting from temperature to wait time
// f(x) = 4737 - 89.6x + 0.423x^2
function interp(temp, cup) {
    x = temp;
    switch (cup) {
        case "Porcelain (small)":
            return (4737 - 89.6*x + 0.423 * x**2);
            break;
        case "Porcelain (large)":
            return (7283 -147*x + 0.744* x**2);
        default:
            return 10000;
            break;
    }
    
}

function timeconvert(time) {
    time = Math.round(time);
    m = Math.floor(time / 60);
    s = time % 60;
    h = Math.floor(m / 60);
    m = m % 60;
    return String(h + " hours " + m + " minutes " + s +  " seconds")
}

$calculate_button.addEventListener('click', () => {

    error_check = false;
    temp = document.getElementById("brewing_time").value;
    console.log(temp)
    if (isNaN(temp) || (temp == "")) {
        temp = document.getElementById("brewing_time_select").value;
        console.log(temp)
        switch (temp) {
            case ("White 75°"): 
                temp = 75;
                break;
            case ("Mate 80°"): 
                temp = 80;
                break;
            case ("Green 85°"): 
                temp = 85;
                break;
            case ("Oolong 85°"): 
                temp = 85;
                break;
            case ("Black 98°"): 
                temp = 98;
                break;
            default:
                temp = 123;
                error_check = true;
                break;
        }
    }

    calc_method = document.getElementById("method").value;
    console.log(calc_method);
    cup = document.getElementById("cup_select").value;
    console.log(cup);

    wait_time = interp(temp,cup);

    if (calc_method == "Calculated model") {
        //document.getElementById("calculated_wait_time").textContent=("Wait time: " + temp + " seconds");
        wait_time = Math.round(wait_time);
        document.getElementById("calculated_wait_time").textContent=("Wait time: " + timeconvert(wait_time));
        console.log(wait_time);
    }
    else {
        // Rounding to nearest whole number
        wait_time = Math.round(wait_time);

        // Using the ceil function to round to nearest 5
        wait_time = Math.ceil(wait_time / 5) * 5;

        global_cooltime = wait_time;

        // Print formated wait time to screen
        document.getElementById("calculated_wait_time").textContent=("Wait time: " + timeconvert(wait_time));
    }

  });

});
    </script>
    
</head style="overflow-x: hidden;">
  <body>
    <nav class="navbar" id="navbar_main" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
      
          <a role="button" id="navbar_burger" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>
      
        <div id="navbar_menu" class="navbar-menu">
          <div class="navbar-start">
            <a class="navbar-item" href="https://tverdal.com">
              Home
            </a>
      
            <a class="navbar-item" href="https://github.com/haraldtv">
              Github
            </a>
      
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link">
                More
              </a>
      
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://tverdal.com/projects.html">
                  Projects
                </a>
                <a class="navbar-item" href="https://tverdal.com/blog.html">
                  Blog
                </a>
                <hr class="navbar-divider">
                <a class="navbar-item" href="mailto:contact@tverdal.com">
                  E-mail me
                </a>
              </div>
            </div>
          </div>
      
          <div class="navbar-end">
            
          </div>
        </div>
      </nav>


  <section class="section">
    <div class="container has-text-centered">
      <h1 class="title">
        Tea Timer!
      </h1>
      <p class="subtitle">
        Tea cooling and brewing timer
      </p>
    </div>
  </section>

  <div class="columns">
    <div class="column is-half is-centered is-offset-one-quarter">
        <div class="card">
            <div class="card-content">
              <div class="media">
                <div class="media-content">
                  <p class="title is-4">Timer</p>
                </div>
              </div>
          
              <div class="content">
                The blue timer (left) indicates cooling time, and the green timer (right) indicates brewing time.
                <br><br>
                
                <div class="columns">
                    <div class="column">
                        <span id="cooling_time_text">Cooling time:</span>
                        <br>
                        <progress class="progress is-info" value="5" max="100" style="width:100%"></progress>
                    </div>
                    <div class="column">
                        <header id="brewing_time_text">Brewing time</header>
                        <progress class="progress is-primary" value="5" max="100" style="width:100%"></progress>
                    </div>
                  </div>
                  <br>

                  <button class="button is-link is-outlined" id="start_timer">
                    <div class="icon-text"><span>Start Timer</span><span class="icon has-text-info"><ion-icon name="alarm"></ion-icon></span></div>
                </button>
                  
              </div>
            </div>
          </div>

    </div>
  </div>


  <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
  </body>
</html>
